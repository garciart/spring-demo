package com.amazonaws.samples;

import java.io.IOException;
import java.util.HashSet;

import com.amazonaws.services.dynamodbv2.document.Item;

public class Application {

    public static void main(String[] args) throws IOException {
        System.out.println("Hello, World");

        DynamoDBLink dynamoDBLink = new DynamoDBLink("medications");

        HashSet<String> medications = new HashSet<String>();
        medications.add("Amphetamine");
        medications.add("Bupropion");
        medications.add("Clopidogrel");
        medications.add("Lorazepam");
        for (String m : medications) {
            System.out.printf("Retrieving %s....\n", m);
            String genericName = m.toUpperCase();
            Item result = dynamoDBLink.retrieveItemByGenericName(genericName);
            if (result != null) {
                System.out.println(result.get("action"));
                System.out.println(result.toJSONPretty());
            } else {
                System.out.printf("Could not retrieve '%s'.\n", m);
            }
        }
        Item result = dynamoDBLink.retrieveItemByGenericName("Amitriptyline".toUpperCase());
        String genericName = result.getString("generic_name");
        String brandName = result.getString("brand_name");
        String action = result.getString("action");
        @SuppressWarnings("unchecked")
        HashSet<String> conditions = (HashSet<String>) result.get("conditions");
        boolean bloodThinner = result.getBoolean("blood_thinner");
        int schedule = result.getInt("schedule");
        String warnings = result.getString("warnings");
        String interactions = result.getString("interactions");
        String sideEffects = result.getString("side_effects");
        String link = result.getString("link");
        System.out.println(genericName + brandName + action + conditions + bloodThinner + schedule + warnings
                + interactions + sideEffects + link);

        System.out.println(bloodThinner);
        // bloodThinner = true;
        bloodThinner = false;
        System.out.println(bloodThinner);

        result = dynamoDBLink.updateItemByGenericName(genericName.toUpperCase(), brandName.toUpperCase(),
                action.toUpperCase(), conditions, bloodThinner, schedule, warnings, interactions, sideEffects, link);
        System.out.println(result.toJSONPretty());

        HashSet<String> new_conditions = new HashSet<String>();
        new_conditions.add("Anxiety");
        new_conditions.add("Seizures");

        // TODO: Check for duplicate
        result = dynamoDBLink.createItem("Lorazepam", "Ativan", "Sedative", new_conditions, false, 4,
                "Lorem ipsum warning", "Lorem ipsum interaction", "Lorem ipsum side effects", "Lorem ipsum link");
        System.out.println(result.toJSONPretty());

        result = dynamoDBLink.deleteItemByGenericName("Lorazepam");
        System.out.println(result.toJSONPretty());
    }
}
